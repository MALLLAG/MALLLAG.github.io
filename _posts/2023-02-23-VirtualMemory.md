---
title: Virtual Memory
tags: OperatingSystem
comments: true
---

# 연속 메모리 할당

프로세스에 연속적인 메모리 공간을 할당하는 방식을 **연속 메모리 할당**이라고 한다.

<img width="282" alt="27" src="https://github.com/MALLLAG/TIL/assets/87420630/49c14ab6-b213-40dc-b629-8987f971ff62">

## 스와핑

메모리에 적재된 프로세스들 중 현재 실행되지 않는 프로세스들이 존재한다. <br>
이러한 프로세스들을 임시로 보조기억장치 일부 영역으로 쫓아내고, 그렇게 해서 생긴 메모리의 빈 공간에 또 다른 프로세스를 <br>
적재하여 실행하는 방식을 **스와핑**이라고 한다.

> 이때 프로세스들이 쫓겨나는 보조기억장치의 일부 영역을 **스왑 영역**이라고 하고 <br>
> 현재 실행되지 않는 프로세스가 메모리에서 스왑 영역으로 옮겨지느 것을 **스왑 아웃**, 반대의 경우를 **스왑 인**이라고 한다.

<br>

## 메모리 할당

비어 있는 메모리 공간에 프로세스를 연속적으로 할당하는 방식에는 **최초 적합, 최적 적합, 최악 적합** 세 가지 방식이 있다.

### 최초 적합

**최초 적합**은 운영체제가 메모리 내 빈 공간을 순서대로 검색하다가 적재할 수 있는 공간을 발견하면 프로세스를 배치하는 방식이다. <br>
이 방식은 검색을 최소화할 수 있고 빠른 할당이 가능하다.

### 최적 적합

**최적 적합**은 운영체제가 빈 공간을 모두 검색해본 후 가장 작은 공간에 프로세스를 배치하는 방식이다.

### 최악 적합

**최악 적합**은 운영체제가 빈 공간을 모두 검색해본 후 가장 큰 공간에 프로세스를 배치하는 방식이다.

<br>

## 외부 단편화

프로세스를 메모리에 연속적으로 배치하는 연속 메모리 할당은 **외부 단편화**문제를 가지고 있어, 메모리를 효율적으로 사용하는 방식은 아니다.

<img width="279" alt="28" src="https://github.com/MALLLAG/TIL/assets/87420630/b6789d56-0eca-4d46-b168-6e075c369327">

위 그림에서 남아있는 메모리 공간은 50MB이지만, 50MB 크기의 프로세스를 적재할 수는 없다. <br>
이러한 메모리 낭비 현상을 **외부 단편화**라고 한다.

<br>
<hr>

## 페이징을 통한 가상 메모리 관리

가상 메모리는 실행하고자 하는 프로그램을 일부만 메모리에 적재하여 실제 물리 메모리 크기보다 큰 프로세스를 실행할 수 있게 하는 기술이다. <br>
이를 가능하게 하는 가상 메모리 관리 기법에는 **페이징**과 **세그멘테이션**이 있다.

### 페이징이란

<img width="203" alt="29" src="https://github.com/MALLLAG/TIL/assets/87420630/0bbd275d-98ce-49fe-a5cd-a2723405c462">

만약 메모리와 프로세스를 일정한 단위로 자르고, 이를 메모리에 불연속적으로 할당할 수 있으면 외부 단편화는 발생하지 않는다. <br>

> 이것을 **페이징**이라고 하고, 페이징은 프로세스의 논리 주소 공간을 **페이지**라는 일정한 단위로 자르고, <br>
> 메모리 물리 주소 공간을 **프레임**이라는 페이지와 동일한 크기의 일정한 단위로 자른 뒤 페이지를 프레임에 할당한다.

페이징에서도 스와핑을 사용할 수 있다. <br>
메모리에 적재될 필요가 없는 페이지들은 보조기억장치로 스왑 아웃되고, 실행에 필요한 페이지들은 메모리로 스왑 인 되는 방식이다. <br>
페이징 시스템에서는 **페이지 아웃**, **페이지 인**이라고 부르기도 한다.

### 페이지 테이블

프로세스가 메모리에 불연속적으로 배치되어 있다면 CPU는 이를 순차적으로 실행할 수 없다. <br>
이를 해결하기 위해 페이징 시스템은 프로세스가 물리 주소에 불연속적으로 배치되더라도 논리 주소에는 연속적으로 배치되도록 **페이지 테이블**을 이용한다.

페이지 테이블은 현재 어떤 페이지가 어떤 프레임에 할당되었는지를 알려준다.


